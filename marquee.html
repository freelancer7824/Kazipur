<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marquee Control Panel</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family: 'Noto Sans Bengali', sans-serif; background: #f4f4f4; margin:0; padding:0;}
    .container { max-width: 800px; margin: 50px auto; padding: 20px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);}
    h1 { text-align: center; margin-bottom: 30px; }
    label { display:block; margin-top: 15px; }
    input, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
    button { background: #007bff; color: #fff; border:none; cursor: pointer; }
    button:hover { background: #0056b3; }
    .hidden { display:none; }
    .status { margin-top: 10px; font-weight: bold; }
    marquee { width: 100%; display: block; background: #fffbcc; padding: 10px 0; color: #000; font-weight: bold; font-size: 16px; }
  </style>
</head>
<body>

  <div class="container">
    <h1>Marquee Control Panel</h1>

    <!-- Login Form -->
    <div id="loginFormContainer">
      <label>Admin Email</label>
      <input type="email" id="loginEmail" placeholder="আপনার ইমেইল" value="admincontrol@gmail.com">
      <label>Password</label>
      <input type="password" id="loginPassword" placeholder="আপনার পাসওয়ার্ড" value="admincontrol">
      <button id="loginBtn">Login</button>
      <div id="loginMessage" class="status" style="color:red;"></div>
    </div>

    <!-- Control Panel -->
    <div id="controlPanel" class="hidden">
      <label>Marquee Text</label>
      <input type="text" id="marqueeTextInput" placeholder="Marquee Text">
      <label>Status</label>
      <select id="marqueeStatus">
        <option value="true">ON</option>
        <option value="false">OFF</option>
      </select>
      <button id="updateMarquee">Update Marquee</button>
      <div id="statusMessage" class="status"></div>
      <button id="logoutBtn" style="margin-top:15px; background:#dc3545;">Logout</button>

      <h3 style="margin-top:20px;">Live Preview</h3>
      <div id="marqueePreviewWrapper">
        <marquee id="marqueePreview" scrollamount="5" behavior="scroll" direction="left">লোড হচ্ছে সর্বশেষ খবর...</marquee>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  
  <script>
    // Firebase Config
    const firebaseConfig = {
  apiKey: "AIzaSyCP6zCBnpY2IgIEPAtiAzuF6_83F4vU-xs",
  authDomain: "vip-news-aa9d1.firebaseapp.com",
  projectId: "vip-news-aa9d1",
  storageBucket: "vip-news-aa9d1.firebasestorage.app",
  messagingSenderId: "105863450293",
  appId: "1:105863450293:web:27d4c874ec3fef0184f8fc",
  measurementId: "G-TDRFDHC7ER"
};
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const marqueeRef = firebase.database().ref("marquee");

    const loginFormContainer = document.getElementById('loginFormContainer');
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    const loginBtn = document.getElementById('loginBtn');
    const loginMessage = document.getElementById('loginMessage');

    const controlPanel = document.getElementById('controlPanel');
    const marqueeTextInput = document.getElementById('marqueeTextInput');
    const marqueeStatus = document.getElementById('marqueeStatus');
    const updateBtn = document.getElementById('updateMarquee');
    const statusMessage = document.getElementById('statusMessage');
    const logoutBtn = document.getElementById('logoutBtn');

    const marqueePreview = document.getElementById('marqueePreview');

    // Login
    loginBtn.addEventListener('click', () => {
      const email = loginEmail.value.trim();
      const password = loginPassword.value.trim();

      auth.signInWithEmailAndPassword(email, password)
      .then(userCredential => {
        const user = userCredential.user;
        if(user.email === "admincontrol@gmail.com"){
          loginFormContainer.classList.add('hidden');
          controlPanel.classList.remove('hidden');
          loadMarqueeData();
        } else {
          loginMessage.textContent = "আপনি অ্যাডমিন নন।";
        }
      })
      .catch(err => {
        loginMessage.textContent = "লগইন ব্যর্থ: " + err.message;
      });
    });

    // Logout
    logoutBtn.addEventListener('click', () => {
      auth.signOut().then(() => {
        controlPanel.classList.add('hidden');
        loginFormContainer.classList.remove('hidden');
      });
    });

    // Load current marquee data
    function loadMarqueeData(){
      marqueeRef.on("value", (snapshot) => {
        const data = snapshot.val();
        if(data){
          marqueeTextInput.value = data.text || "";
          marqueeStatus.value = data.isOn ? "true" : "false";
          updatePreview(data.text, data.isOn);
        }
      });
    }

    // Update marquee
    updateBtn.addEventListener("click", () => {
  const text = marqueeTextInput.value.trim();
  const isOn = marqueeStatus.value === "true";
  
  marqueeRef.set({ text, isOn })
    .then(() => alert("Marquee updated!"))
    .catch(err => alert("Error: " + err.message));
});

    function updatePreview(text, isOn){
      marqueePreview.textContent = text || "লোড হচ্ছে সর্বশেষ খবর...";
      marqueePreview.parentElement.style.display = isOn ? "block" : "none";
    }

  </script>
</body>
</html>