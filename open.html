<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>পুরো পোস্ট</title>
  <link rel="stylesheet" href="style.css">
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
  <div id="postContainer" class="container" style="max-width:800px; margin:20px auto;">
    <p>লোড হচ্ছে...</p>
  </div>

  <script>
    // Firebase config (main.js এর মতোই)
    const firebaseConfig = {
      apiKey: "AIzaSyCP6zCBnpY2IgIEPAtiAzuF6_83F4vU-xs",
      authDomain: "vip-news-aa9d1.firebaseapp.com",
      projectId: "vip-news-aa9d1",
      storageBucket: "vip-news-aa9d1.firebasestorage.app",
      messagingSenderId: "105863450293",
      appId: "1:105863450293:web:27d4c874ec3fef0184f8fc",
      measurementId: "G-TDRFDHC7ER"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // URL থেকে postId নেওয়া
    const urlParams = new URLSearchParams(window.location.search);
    const postId = urlParams.get("postId");

    const postContainer = document.getElementById("postContainer");

    function formatBengaliDate(timestamp) {
      if (!timestamp) return "";
      const date = timestamp.toDate();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('bn-BD', options);
    }

    async function loadPost() {
      if (!postId) {
        postContainer.innerHTML = "<p>পোস্ট পাওয়া যায়নি।</p>";
        return;
      }

      try {
        const doc = await db.collection("news").doc(postId).get();
        if (!doc.exists) {
          postContainer.innerHTML = "<p>এই পোস্টটি আর পাওয়া যাচ্ছে না।</p>";
          return;
        }

        const news = doc.data();
        postContainer.innerHTML = `
          <article class="card card-large">
            <img src="${news.imageUrl}" alt="${news.title}" style="max-width:100%; border-radius:8px;">
            <div class="card-body">
              <span class="category-tag">${news.category}</span>
              <h1 class="title">${news.title}</h1>
              <div class="meta">
                <span>${news.source || 'কাজিপুর এক্সপ্রেস '}</span>
                <span class="meta-dot"></span>
                <span>${formatBengaliDate(news.createdAt)}</span>
              </div>
              <p style="margin-top:15px; font-size:18px; line-height:1.8;">
                ${news.excerpt}
              </p>
            </div>
          </article>
        `;
      } catch (error) {
        console.error("Error loading post:", error);
        postContainer.innerHTML = "<p>পোস্ট লোড করতে সমস্যা হয়েছে।</p>";
      }
    }

    loadPost();
  </script>
</body>
</html>